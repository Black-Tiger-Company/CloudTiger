# Project configuration

- [Project configuration](#project-configuration)
	- [Setup the project](#setup-the-project)
		- [Guided configuration](#guided-configuration)
		- [Manual configuration](#manual-configuration)
			- [.env](#env)
			- [Provider secret](#provider-secret)
	- [Next step](#next-step)

Once you have installed CloudTiger with its technical prerequisites, it is time to preprare a project folder to use it.

You can create a blank CloudTiger project folder by running this command :

```bash
cloudtiger <PROJECT_PATH> init folder
```

You can also manually create a project folder that respect the structure described below.

A CloudTiger project folder has the following structure :

```txt
<PROJECT_FOLDER>
├── config
├── scopes
├── secrets
├── standard
│   ├── playbooks
│   ├── ansible_requirements.yml
│   └── standard.yml
├── manifests
└── .env
```

CloudTiger groups infrastructures as "scopes". Scopes are simply a way of grouping infrastructure resources together to make them easy to manipulate and oversee. You can group resources as you want, and you can use a hierarchical structure of scopes.

A scope is defined by a tree-like hierarchy of folders, terminating with a file named `config.yml`.

Thus, the project folder contains the following subfolders :

- The `config` folder contains the "scopes" of the project, as a hierarchy of subfolders, each of them containing a `config.yml` file
- The `scope` folder contains all intermediate files that will be generated by CloudTiger from the `config.yml` files in order to execute Terraform and Ansible
- The `secrets` folder contains credentials for the APIs of the private or public cloud provider, and for the APIs of software services you will create and configure further during the use of CloudTiger
- The `standard` folder is an optional folder, that can contains :
  - a `playbooks` folder, where you can store custom ansible playbooks dedicated to your project. These playbooks can easily be added to your project's current ansible folder, see documentation [here](./commands.md)
  - an `ansible_requirements.yml` file, where you can set the path of external ansible roles to use for your project. The structure of `ansible_requirements.yml` is explained [here](./commands.md)
  - a `standard.yml` file, where you can set many default values for the `config.yml` scope files of your CloudTiger project. An example for `standard.yml` is available [here](../cloudtiger/libraries/internal/gitops/standard/standard.yml)
- The `.env` file contains some global parameters for your project

## Setup the project

Once you have created your CloudTiger root project, you can set the credentials for your SSH access and your cloud provider account(s).

CloudTiger offers two ways of doing it :

- a guided configuration
- a manual configuration

### Guided configuration

Run this command, that will prompt you a few questions about your credentials :

```bash
cloudtiger <PATH_TO_YOUR_PROJECT_FOLDER> init config
```

Once you have provided all the data, you should normally be ready to execute CloudTiger to create some resources, you can proceed to [scope configuration](scope_configuration.md).

If for any reason you need to manually edit your CloudTiger project folder configuration, check the next section.

### Manual configuration

If you need to manually configure your CloudTiger project folder for some reasons, check the following files :

#### .env

To setup your CloudTiger project, you must first set the `.env` file. It should contains the following content :

```bash
CLOUDTIGER_PRIVATE_SSH_KEY_PATH=...
CLOUDTIGER_SSH_USERNAME=...
CLOUDTIGER_SSH_PASSWORD=...
```

If you have created the project folder with the `cloudtiger` command, you can also do :

```
cp .env.tpl .env
```

Then edit the `.env` file

`CLOUDTIGER_PRIVATE_SSH_KEY_PATH` : you should set this variable to the path of the private SSH key you will use to connect to the VM you will create. Optionally, you can avoid using this variable (in this case, delete completely the line from the .env file) if you plan to use dedicated SSH key pairs for your project. See further for this option

`CLOUDTIGER_SSH_USERNAME` : you should set this variable to the SSH username you plan to use on the VMs you will instantiate. Optionnally, you can avoid using this variable (in this case, delete completely the line from the .env file) if you plan to use only the default system user of the VMs you want to create. See further for this option.

`CLOUDTIGER_SSH_PASSWORD` : you should set this variable if you are plan to declare the `CLOUDTIGER_SSH_USERNAME` as the username for SSH access to your VMs. WARNING : for security and technical reason, your password must be stored in base64 format. If you don't know how to put your password into base64, use this command :

```bash
echo <YOURPASSWORD> | base64
```

You can also use bash shell in this variable, for example :

```bash
CLOUDTIGER_SSH_PASSWORD=$(cat /path/to/secure/password/file | base64)
```

#### Provider secret

Once you have set the "global" `.env` file, you must set the credentials for the provider you want to use.

If have created the project folder with the `cloudtiger` command, you can do :

```
cp secrets/<PROVIDER>/.env.tpl secrets/<PROVIDER>/.env
```

Then edit the `secrets/<PROVIDER>/.env` file.

The content of the file depends on your cloud provider, and you may potentially have to add some extra credential files. Follow the instructions [here](prerequisites_cloud_credentials.md)

## Next step

Once everything is done, you can proceed to [scope configuration](scope_configuration.md)